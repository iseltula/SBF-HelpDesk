<script type="text/javascript">
  RED.nodes.registerType('prompt-dialog', {
      category: 'SBF',
      color: '#FFD1A7',
      outputs: 1,
      inputs: 1,
      defaults: {
          name: {
              value: '',
              required: true
          },
          dialogType: {
              value: '',
              required: true
          }
      },
      icon: 'bridge.png',
      label: function () {
          return this.name || 'prompt-dialog';
      },
      labelStyle: function () {
          return this.name === '' ? 'node_label_italic' : '';
      },
      mixins: {
          botPersonality: {
              container: "#node-input-dialog-container"
          }
      }
  });
</script>

<script type="text/x-red" data-template-name="prompt-dialog">
  <div class="form-row">
    <label for="node-input-name">Name</label>
    <input type="text" id="node-input-name" placeholder="Name" />
  </div>
  <div class="form-row">
    <label for="node-input-dialogType">Dialog Type</label>
    <select id="node-input-dialogType">
      <option value="text" selected>Text</option>
      <option value="number">Number</option>
      <option value="confirm">Confirm</option>
      <option value="attachment">Attachment</option>
      <option value="time">Time</option>
    </select>
  </div>
  <h3>Dialog Message</h3>
  <div class="form-row">
    <ol id="node-input-dialog-container"></ol>
  </div>
</script>

<script type="text/x-red" data-help-name="prompt-dialog">
  <p><strong>Purpose: </strong> to accept user input.</p>
  <p><strong>How to use: </strong></p>
  <ul>
    <li>Set the name of the dialog.</li>
    <li>Select the dialog type.</li>
    <ul>
      <li><strong>Confirm:</strong> accepts user input as a boolean value.
        <p><pre><code>response: Boolean  //response when type is Confirm</code></pre></p>
      </li>

      <li><strong>Text:</strong> accepts user input as a string.
          <p><pre><code>response: String  //response when type is Text</code></pre></p>
      </li>
      <li><strong>Number:</strong> accepts user input as number.
           <p><pre><code>response: Number  //response when type is Text</code></pre></p>
      </li>
      <li><strong>Attachment:</strong> accepts user input as file/media.
          <p><pre><code>response: {
          contentType: type  //type of file,
          contentUrl: url   //url for the content 
          }  //response when type is Attachment</code></pre></p>
      </li>
    </ul>
    <li>Set the dialog text to the dialog.</li>
  </ul>
  <p><strong>Inputs: </strong> sbf object from the Intent Matcher and any result from previous dialogs.</p>
  <p><strong>Outputs: </strong> sets a new property to the message object.</p>
  <p><pre><code>node.send({
      sbf: {
        session: Object, // object of the Bot Framework session
        botServer: {
          bot: Object, // object of the Bot Framework Universal Bot
          intent: Object, // object of the builder.IntentDialog for LUIS
          connector: Object, // object of the builder.ChatConnector for listening to a URL
        },
        luisArgs: Object // object of the LUIS intent matching object        
    },
    payload: {
          response: {..} // response depending on the type.
        });</code></pre></p>
  <p><strong>Quick Tips: </strong></p>
  <ul>
    <li>It is recommended to Deploy afer creating each dialog, to save the changes.</li>
    <li>If when deploy an error is display. Just re-open the dialog and Save it again. </li>    
  </ul>
</script>
